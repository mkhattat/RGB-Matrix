<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Smart Matrix: Quick Start Guid</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Smart Matrix
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Quick Start Guid </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="main.JPG" alt="main.JPG"/>
</div>
 <dl class="section author"><dt>Author</dt><dd>Mostafa Khattat (<a href="#" onclick="location.href='mai'+'lto:'+'mos'+'ta'+'fa@'+'kh'+'att'+'at'+'.nl'; return false;">mosta<span style="display: none;">.nosp@m.</span>fa@k<span style="display: none;">.nosp@m.</span>hatta<span style="display: none;">.nosp@m.</span>t.nl</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 (last modified 2016-06-20) </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>boost license (some files public domain)</dd></dl>
<p>Smart Matrix is a library to control 64x32 led pannels. A dot-matrix display is a display device used to display information, photos or short video clip animations. The display consists of a dot matrix of RGB lights arranged in a rectangular configuration such that by switching on or off selected lights, text or graphics can be displayed. Smart Matrix is a library to control such matrix. The library is written in c++ Object Oriented. The main class, <a class="el" href="matrix_8hpp.html">matrix.hpp</a>, is used to declare and initialize the led matrix and also there are other classes to help you control the led matrix. Here you will find a quick start guide with some example to show you how the library works.</p>
<p><b>Wiring:</b> </p>
<p>This section describes default wiring and pins numbers. The RGB panels are normally designed for chaining (linking end-to-end into larger displays)…the output of one panel connects to the input of the next, down the line. Flip the matrix over so you’re looking at the back, holding it with the two sockets situated at the left and right edges. One of them is INPUT. That's the socket we are intersting. </p><div class="image">
<img src="led_matrix_orient.png" alt="led_matrix_orient.png"/>
</div>
<p> You need to wire you gpio pins as bellow: </p><div class="image">
<img src="wiring.jpg" alt="wiring.jpg"/>
</div>
<a class="anchor" id="multi_row"></a>
<table class="doxtable">
<caption>Wiring Table</caption>
<tr>
<th>Pin Names </th><th>Arduino Digital Pin Names </th></tr>
<tr>
<td>R1</td><td>digital pin 35 </td></tr>
<tr>
<td>B1</td><td>digital pin 33 </td></tr>
<tr>
<td>R2</td><td>digital pin 38 </td></tr>
<tr>
<td>B2</td><td>digital pin 36 </td></tr>
<tr>
<td>R1</td><td>digital pin 35 </td></tr>
<tr>
<td>A</td><td>digital pin 25 </td></tr>
<tr>
<td>C</td><td>digital pin 27 </td></tr>
<tr>
<td>CLK</td><td>digital pin 39 </td></tr>
<tr>
<td>OE</td><td>digital pin 42 </td></tr>
<tr>
<td>G1</td><td>digital pin 34 </td></tr>
<tr>
<td>G2</td><td>digital pin 37 </td></tr>
<tr>
<td>B</td><td>digital pin 26 </td></tr>
<tr>
<td>D</td><td>digital pin 28 </td></tr>
<tr>
<td>Latch</td><td>digital pin 43 </td></tr>
</table>
<p><b>Matrix:</b> </p>
<p>To start using the led pannel you have to initialize it. You can do it in two ways:</p><ul>
<li>You can use the default wiring (Highly recommended)</li>
<li>You can use your own wiring and pinnen (Not recommended! because of performance issues)</li>
</ul>
<p>Here is such an example of using matrix library with default wiring: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="matrix_8hpp.html">matrix.hpp</a>&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="classmatrix.html">matrix</a> led(64, 32, <span class="keyword">true</span>);</div><div class="line">led.start();</div></div><!-- fragment --><p>But as already said you can use your own wiring setup. In that case you have to pass the pin number of every wire to the constructor: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="matrix_8hpp.html">matrix.hpp</a>&quot;</span></div><div class="line"></div><div class="line">    <a class="code" href="classmatrix.html">matrix</a> led(64, 32, <span class="keyword">true</span>, target::pins::d43, target::pins::d42, target::pins::d39,</div><div class="line">            target::pins::d25, target::pins::d26, target::pins::d27, target::pins::d28,</div><div class="line">            target::pins::d33, target::pins::d34, target::pins::d35, target::pins::d36,</div><div class="line">            target::pins::d37, target::pins::d38);</div><div class="line">    led.start();</div></div><!-- fragment --><p> The problem with above code is that you can not get the maximum performance out of you microcontroller and thus you will notice flickers and lag in animation. It's recommended to use de default wiring. To setup your led matrix with default wiring use the documentation above. for more information about both constructor refer to <a class="el" href="matrix_8hpp.html">matrix.hpp</a> class.</p>
<p>In both cases (default wiring or custom wiring) of above examples 64 is the width of led matrix and 32 is the height. Library supports a double buffering. To enable it you should pass true as 3e arrgument. The hardware of led matrix can display only two rows at once. In order to light all pixels we have to turn on and off every row quickly so that in our eyes it seems that the alle pixels are on. To that the library uses a timer interrupt functionality of Arduino Due. led.start() enables auto update, so you don't have to worry about turning on or off panel rows.</p>
<p><b> Note: </b> The library uses timer interrupt 1 channel 1 to update the led pannel. So if you plan to use timer interrupts in your program you should not use this interrupt channel.</p>
<p>If you enable double buffering, drawing any pixel will occur in the back buffer. The result is not visible until you swap the buffers: </p><div class="fragment"><div class="line">led.drawPixel(0,0, 0xFFFFFF);</div><div class="line">led.swap_buffer(<span class="keyword">false</span>);</div></div><!-- fragment --><p> In the above example we light up the pixel (0,0) and specify it's color as "White". Colors can be in (hexa)decimal values between 0 and 2^24-1 or seprate RGB colors: </p><div class="fragment"><div class="line">led.drawPixel(0,0, 255, 255, 255);</div></div><!-- fragment --><p> Because we already enabled double buffering we have to swap buffers to turn on pixel (0,0). This function requires an bool argument. If you need to copy the values of the updated buffer into the new back buffer you need to pass true to the copy varianle. But if you only need to swap the front buffer with the back buffer and you don't care about the old buffer (maybe because you clear the screen afterwards) the pass false to the copy variable. To avoid "tearing" swapping of buffers takes place at the end of a complete screen refresh cycle.</p>
<p><b>Note: </b> This function doesn't have any effect if you didn't enable the double buffer in the constructor.</p>
<p>In order to fill the screen with a specific color you can use fillscreen function. </p><div class="fragment"><div class="line">led.fillScreen(0x87ADFF);</div></div><!-- fragment --><p> Here you can also use RGB colors: </p><div class="fragment"><div class="line">led.fillScreen(135, 173, 255);</div></div><!-- fragment --><p> There is also a clear function to clear the screen: </p><div class="fragment"><div class="line">led.clear();</div></div><!-- fragment --><p><b> Show Images: </b></p>
<p>With your led pannel you can also show pictures. The max size of pictures should be at the max size of pannel. So if you have a 64 width x 32 height pannel, the size of you pictures should be maximum 64x32. The library does not scale the images for you. The library uses a special raw format for the photos. There is a python command line script helps you convert your images at any format to the required raw format. This python script is <a class="el" href="readbmp_8py.html">readbmp.py</a>. In order to use this script you need to install pillow library. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python -m pip install Pillow</div></div><!-- fragment --><p> The readbmp script needs two arguments, path to the photo and the name of the new raw file: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python readbmp.py photo.jpg myphoto</div></div><!-- fragment --><p> The result is a .h file you can include in your projects and use it to show the photo on the screen: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;myphoto.h&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="class_image.html">Image</a> <a class="code" href="namespacemake__font.html#a753f72600cf30f9a58da232f850791eb">im</a>(led, myphoto, <a class="code" href="classvector.html">vector</a>(35,0));</div><div class="line"><a class="code" href="namespacemake__font.html#a753f72600cf30f9a58da232f850791eb">im</a>.draw();</div><div class="line">led.swap_buffer(<span class="keyword">false</span>);</div></div><!-- fragment --><p> in the above example <a class="el" href="classvector.html" title="Implementation of vector class to store x and y. ">vector(35,0)</a> is the location of the library. in this library you should pass location and size of something as a <a class="el" href="classvector.html" title="Implementation of vector class to store x and y. ">vector(x,y)</a>. See also <a class="el" href="vector_8hpp.html">vector.hpp</a></p>
<p><b> Show Animated Images: </b></p>
<p>Not only Images can be shown but Animated Images can also be shown on the led matrix. To use this feature you have to convert a gif animation file to a raw animated image. To do this you can use a python script <a class="el" href="make__animation_8py.html">make_animation.py</a>. This script depends on a pillow library: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;/// python -m pip install Pillow</div></div><!-- fragment --><p> The <a class="el" href="make__animation_8py.html">make_animation.py</a> script needs two arguments, path to the gif file and the name of the new raw animated file: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python make_animation.py animation.gif myanimation</div></div><!-- fragment --><p> The result is a .h file you can include in your projects and use it to show the animated image on the screen: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;myanimation.h&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="class_animated_image.html">AnimatedImage</a> aIm(led, animation, <a class="code" href="classvector.html">vector</a>(15, 0));</div><div class="line">aIm.draw();</div></div><!-- fragment --><p> The above code prints animation at location (15, 0). De default is one time from start to end with a update interval 10 milliseconds between each frame. In order to change de update interval and loop option you can declare the function as: </p><div class="fragment"><div class="line">aIm.draw(5, <span class="keyword">true</span>);</div></div><!-- fragment --><p> The above code prints animation with 5 milliseconds update interval between each frame and loop option set to true.</p>
<p><b> Note: </b> The <a class="el" href="namespacemake__font.html#a91f038177eb213c9d6b5b542464b5e34">draw()</a> function of <a class="el" href="class_animated_image.html" title="AnimateImage implementation for raw gif files. ">AnimatedImage</a> class doesn't need the buffer_swap operation.</p>
<p>You can also print a specific frame of an animated image file: </p><div class="fragment"><div class="line">aIm.drawFrame(0);</div><div class="line">led.swap_buffer();</div></div><!-- fragment --><p> The value of frame number must be smaller than total frames, otherwise nothing will be printed on the screen. You can get total number of frames of an animated image by: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> frames;</div><div class="line">frames = aIm.getTotalFrames();</div></div><!-- fragment --><p> The result is an intger value.</p>
<p><b> Show Text: </b></p>
<p>Texts can be shown on the screen by using <a class="el" href="class_string.html" title="String class implements text manipulation to be used by a Screen object e.g. matrix object...">String</a> class. This class needs a font. You can convert any .ttf font to font supported by the library. In order to convert a font you can use a python script <a class="el" href="make__font_8py.html">make_font.py</a>. This script depends on a pillow python library. You have to first install it: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python -m pip install Pillow</div></div><!-- fragment --><p> The <a class="el" href="make__font_8py.html">make_font.py</a> script accepts 3 arguments: font path, size of the font you want to use and the name of new font: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python make_font.py tahoma.ttf 10 tahoma10</div></div><!-- fragment --><p> The result is a .h file. A tahoma.ttf font converted with size of 10 to a supported font with name tahoma10. You can use this font by string class to show text or scroll text on the screen: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;tahoma10.h&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="class_string.html">String</a> str(led, tahoma10, (<span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Hallo World!&quot;</span>, 0xFA0000, <a class="code" href="classvector.html">vector</a>(0, 10));</div><div class="line">str.draw();</div><div class="line">led.swap_buffer(<span class="keyword">false</span>);</div></div><!-- fragment --><p> "Hallo World!" is the string to be written on the screen. You have to typecast your string first to char*. for example if you want to print "Hallo World" you have to pass it like this: (char*)"Hallo World". You can also use RGB colors: </p><div class="fragment"><div class="line"><a class="code" href="class_string.html">String</a> str(led, tahoma10, (<span class="keywordtype">char</span>*)<span class="stringliteral">&quot;Hallo World!&quot;</span>, 255, 255, 255, <a class="code" href="classvector.html">vector</a>(0, 10));</div></div><!-- fragment --><p>In order to scroll text from right to left on the screen you can use scroll function: </p><div class="fragment"><div class="line">str.scroll();</div></div><!-- fragment --><p> This function scrolls the text from right to left at the speed of 10 milliseconds. By default the loop is set to false and the start point of scroll is at width = 64; In order to change the default behavior you can declare the above function like this: </p><div class="fragment"><div class="line">str.scroll(15, <span class="keyword">true</span>, 32);</div></div><!-- fragment --><p> The above code scrolls the text at the speed of 15 milliseconds per pixel and the loop is set to true. Also notice that the start point of scrolling is width = 32. It means the text will be scrolled from pixel(32, y) to pixel(0,y).</p>
<p><b>Note:</b> By using scroll function you do not need to use swap_buffer(); </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
